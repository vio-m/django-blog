{% extends 'store/main.html' %}
{% load static %}
{% block content %}
<div class="row">
     <div class="col-lg-9">
          <div class="box-element">
               <a  class="btn btn-outline-dark" href="{% url 'store' %}">Continue Shopping</a>
               <a  style="float:right; margin:5px;" class="btn btn-outline-success" href="{% url 'checkout' %}">Checkout</a>
               <br>
               <br>
               <table class="table">
                    <tr>
                         <th><h5>Items: <strong>{{ order.get_cart_items }}</strong></h5></th>
                         <th style="text-align:right"><h5>Total:<strong> ${{ order.get_cart_total|floatformat:2 }}</strong></h5></th>
                    </tr>
               </table>
          </div>

          <br>
          <div class="box-element">
               <div class="cart-row">
                    <div style="flex:2"></div>
                    <div style="flex:2"><strong>Product</strong></div>
                    <div style="flex:1"><strong>Price/pc.</strong></div>
                    <div style="flex:1"><strong>Qty</strong></div>
                    <div style="flex:1"><strong>Total</strong></div>
               </div>

               {% for item in items %}
               <div class="cart-row">
                    {% for image in images %}
                    {% if image.product.id == item.product_id %}
                    <div style="flex:2"><img class="row-image" src="{{ image.imageURL }}"></div>
                    {% endif %}
                    {% endfor %}
                    <div style="flex:2"><p>{{ item.product.name }}</p></div>
                    <div style="flex:1"><p>${{ item.product.price|floatformat:2 }}</p></div>
                    <div style="flex:1">
                         <p class="quantity">{{ item.quantity }}</p>
                         <div class="quantity">
                              <img data-product={{ item.product.id }} data-action="add" class="chg-quantity update-cart" src="{% static  'images/arrow-up.png' %}">
                              <img data-product={{ item.product.id }} data-action="remove" class="chg-quantity update-cart" src="{% static  'images/arrow-down.png' %}">
                         </div>
                    </div>
                    <div style="flex:1"><p>${{ item.get_total|floatformat:2 }}</p></div>
               </div>
               {% endfor %}
          </div>
     </div>
     <div class="col-lg-3 box-element">
          <div class="card mb-3">
               <div class="card-body">
                    <form method="POST">
                         {% csrf_token %}
                         <div class="form-group">
                              <label>Have coupon?</label>
                              <div class="input-group">
                                   <input type="text" class="form-control coupon" name="code"  title="enter 'code01' for discount"  placeholder="Coupon code">
                                   <span class="input-group-append">
                                        <button type="submit" class="btn btn-primary btn-apply coupon">Apply</button>
                                   </span>
                              </div>
                         </div>
                    </form>
               </div>
          </div>

          <div class="card">
               <div class="card-body">
                    <dl class="dlist-align">
                         <dt>Full price:</dt>
                         <dd class="text-right text-dark b ml-3">${{ order.get_cart_total|floatformat:2 }}</dd>
                    </dl>
                    <dl class="dlist-align">
                         <dt>Discount:</dt>
                         {% if order.get_discount %}
                         <dd class="text-right text-danger ml-3">-{{ order.get_discount }}%</dd>
                         {% else %}
                         <dd class="text-right text-danger ml-3"> 0 %</dd>
                         {% endif %}
                    </dl>
                    <dl class="dlist-align">
                         <dt>Final price:</dt>
                         <dd class="text-right text-dark b ml-3"><strong>${{ order.get_cart_total_discounted|floatformat:2 }}</strong></dd>
                    </dl>
                    <dl class="dlist-align">
                         <dt>You saved:</dt>
                         <dd class="text-right text-dark b ml-3">${{ order.get_saved|floatformat:2 }}</dd>
                    </dl>

                    {% include 'store/messages.html' %}

               </div>
          </div>
     </div>


</div>
{% endblock content %}